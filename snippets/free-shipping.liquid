<style>
  #free-shipping-wrapper {
    margin: 1rem 0;
    min-width: 100%;
  }

  #free-shipping-text {
    margin: 0 0 .5rem;
    font-size: 14px;
    text-align: center;
  }

  .free-shipping-bar {
    width: 100%;
    height: 10px;
    background: #e0e0e0;
    border-radius: 5px;
    position: relative;
    overflow: visible;
  }

  .free-shipping-progress {
    height: 100%;
    width: 0%;
    background: #93C572;
    transition: width .4s;
    position: relative;
    display: block !important;
  }

  .free-shipping-progress::after {
    content: '';
    position: absolute;
    right: 0;
    top: 50%;
    transform: translate(50%, -50%);
    width: 16px;
    height: 16px;
    background: #93C572;
    border: 2px solid #fff;
    border-radius: 50%;
    box-shadow: 0 0 2px rgba(0, 0, 0, .25);
  }
</style>

<div id="free-shipping-wrapper">
  <p id="free-shipping-text">
    You are â‚¹<span id="free-shipping-amount">0</span> away from free shipping
  </p>
  <div class="free-shipping-bar">
    <div id="free-shipping-progress" class="free-shipping-progress"></div>
  </div>
</div>

<script>
  window.updateFreeShippingProgress = function () {
    fetch('/cart.js')
      .then(r => r.json())
      .then(cart => {
        const threshold = {{ settings.free_shipping | default: 1000
      }};
  const total = cart.total_price / 100;
  const left = Math.max(threshold - total, 0);
  const pct = Math.min((total / threshold) * 100, 100);

  const txt = document.getElementById('free-shipping-text');
  const amt = document.getElementById('free-shipping-amount');
  const bar = document.getElementById('free-shipping-progress');

  if (bar) bar.style.width = pct + '%';

  if (left > 0) {
    if (amt) amt.textContent = left.toLocaleString('en-IN');
    if (txt && txt.style.display === 'none') txt.style.display = '';
  } else {
    if (txt) txt.textContent = 'ðŸŽ‰ Youâ€™ve unlocked free shipping!';
  }
      });
  };

  document.addEventListener('DOMContentLoaded', window.updateFreeShippingProgress);
</script>